#!/usr/bin/env python
# boofuzz template for Solar FTP 2.1.1 PASV command

from boofuzz import *

host = "192.168.1.10"
port = 21

def main():
    session = Session(target=Target(connection=SocketConnection(host, port, proto='tcp')))

    s_initialize("user")
    s_static("USER")
    s_delim(" ")
    s_string("anonymous")
    s_static("\r\n")

    s_initialize("pass")
    s_static("PASS")
    s_delim(" ")
    s_static("test")
    s_static("\r\n")

    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))

    session.fuzz()
if __name__ == "__main__":
    main()
